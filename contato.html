<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="utf-8">
    <title>Rodrigo Davi</title>
    <link href="https://fonts.googleapis.com/css?family=Raleway&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/estilo.css">
    <link rel="icon" href="img/icon.png">
</head>
<body>
    <div id="slide">
        <a id="fechar" href="">X</a>
        <img src="" alt="">
    </div>
    <header>
        <div id="logo">
            <a href="index.html">
                <h1>Rodrigo Davi</h1>
            </a>
        </div>
        <nav>
            <a href="index.html">Sobre</a>
            <a href="trabalhos.html">Trabalhos</a>
            <a href="contato.html" id="selecionado">Contato</a>
        </nav>
    </header>
    <div id="principal">
        <section class="part1">
            <form method="" action="" autocomplete="on">
                Nome:<span class="obrigatorio">*</span> <br><input type="text" name="nome" id="nome">
                <span class="obrigatorio alert">Campo obrigatório!</span><br>
                Email:<span class="obrigatorio">*</span><br><input type="email" name="email" id="email">
                <span class="obrigatorio alert">Campo obrigatório!</span><br>
                Mensagem: <br><textarea name="msg" id="msg" cols="30" rows="10"></textarea><br><br>
                <a id="btn" href="#">Enviar</a>
            </form>
        </section>
    </div>
    <footer>
        <br><br>
        <span>&copy; Dualiri</span>

        <!-- The core Firebase JS SDK is always required and must be listed first -->
        <script src="https://www.gstatic.com/firebasejs/6.1.1/firebase-app.js"></script>

        <script src="https://www.gstatic.com/firebasejs/5.9.1/firebase-database.js"></script>

        <!-- TODO: Add SDKs for Firebase products that you want to use
            https://firebase.google.com/docs/web/setup#config-web-app -->

        <script>
        // Your web app's Firebase configuration
        var firebaseConfig = {
            apiKey: "AIzaSyCZm_55Cl2DFror0efHEmyRRaJWblUDRk4",
            authDomain: "portifolio-a74bc.firebaseapp.com",
            databaseURL: "https://portifolio-a74bc.firebaseio.com",
            projectId: "portifolio-a74bc",
            storageBucket: "",
            messagingSenderId: "889584705371",
            appId: "1:889584705371:web:f167dc230a4da877"
        };
        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        //var db = firebase.database(); não tou utilizando

        document.getElementById('btn').addEventListener('click', function(x){
            var nome = document.getElementById('nome').value
            var email = document.getElementById('email').value
            var desc = document.getElementById('msg').value

            var y = document.getElementsByClassName('alert')[1]
            var x = document.getElementsByClassName('alert')[0]
            x.style.display = 'none'
            y.style.display = 'none'

            if (email == "") {
                y.style.display = 'block'
            }
            if (nome == "") {
                x.style.display = 'block'
            } else {/*
                firebase.database().ref('dados/' + nome).set({
                    nome: nome,
                    email: email,
                    descricao: desc
                })*/

/////////////////////////////////////////////////////////////////////////////
/*
                var ref = firebase.database().ref("dados/");
                ref.once("value")
                .then(function(snapshot) {
                    var a = snapshot.exists();  // true
                    //var b = snapshot.child("name").exists(); // true
                    var b = snapshot.child("lucas").exists(); // true
                    var c = snapshot.child("name/first").exists(); // true
                    var d = snapshot.child("name/middle").exists(); // false
                    alert(a + " " + b + " " + c + " " + d)
                });

                var query = firebase.database().ref("dados").orderByKey();
                query.once("value")
                .then(function(snapshot) {
                    snapshot.forEach(function(childSnapshot) {
                    // key will be "ada" the first time and "alan" the second time
                    var key = childSnapshot.key;
                    // childData will be the actual contents of the child
                    var childData = childSnapshot.val();
                    alert(key + "     " + childData)
                    });
                });*/
                var entrada = {};
                entrada.nome = nome
                entrada.email = email
                entrada.mensagem = desc

                firebase.database().ref('dados').push(entrada).then(function(data){
                    //window.location.href = 'entry.html?id='+data.getKey()
                    //caso queira que faça alguma ação
                }).catch(function(error){
                    alert(error)
                    console.error(error)
                })
            }
        })       
        </script>

    </footer>
</body>
</html>